// Copyright (c) 2023 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-tools-evalpoly@v0.1.1-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-betainc@v0.1.0-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-expm1@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-log1p@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-asin@v0.1.0-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-beta@v0.1.0-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sqrt@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-abs@v0.1.0-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-exp@v0.1.0-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-pow@v0.1.0-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sin@v0.1.0-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-max@v0.1.1-esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-min@v0.1.1-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-ln@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-smallest-normal@v0.1.1-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-half-pi@v0.1.1-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-eps@v0.1.1-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-erfcinv@esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-floor@esm/index.mjs";import x from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-ldexp@esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-round@esm/index.mjs";import k from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-acos@esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-cos@esm/index.mjs";import q from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-sqrt-two@esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-pi@esm/index.mjs";import z from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gamma-delta-ratio@esm/index.mjs";import A from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-tools-evalpoly@esm/index.mjs";import B from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-exp@esm/index.mjs";import C from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sin@esm/index.mjs";import D from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-max@esm/index.mjs";import E from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-signum@esm/index.mjs";import F from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gammaincinv@esm/index.mjs";import G from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-smallest-subnormal@esm/index.mjs";import H from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-abs@esm/index.mjs";import I from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-max@esm/index.mjs";import{assign as J}from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-kernel-betainc@esm/index.mjs";var K=[1,0,0,0,0,0,0,0,0,0];function L(e,s){var n,i,r;return i=z(e/2,.5)*m(e*y)*(s-.5),n=1/e,K[1]=0===(r=n)?.16666666666666666:.16666666666666666+.16666666666666666*r,K[2]=function(t){return 0===t?.058333333333333334:.058333333333333334+t*(.06666666666666667+.008333333333333333*t)}(n),K[3]=function(t){return 0===t?.0251984126984127:.0251984126984127+t*(.026785714285714284+t*(.0017857142857142857+.0001984126984126984*t))}(n),K[4]=function(t){return 0===t?.012039792768959435:.012039792768959435+t*(.010559964726631394+t*(t*(.0003747795414462081+27557319223985893e-22*t)-.0011078042328042327))}(n),K[5]=function(t){return 0===t?.003837005972422639:.003837005972422639+t*(.00610392115600449+t*(t*(.0005945867404200738+t*(2.505210838544172e-8*t-6270542728876062e-20))-.0016095979637646305))}(n),K[6]=function(t){return 0===t?.0032177478835464946:.0032177478835464946+t*(.0010898206731540065+t*(t*(.0006908420797309686+t*(t*(154012654012654e-19+1.6059043836821613e-10*t)-.00016376804137220805))-.0012579159844784845))}(n),K[7]=function(t){return 0===t?.001743826229834001:.001743826229834001+t*(3353097688001788e-20+t*(t*(.0006451304695145635+t*(t*(49255746366361444e-21+t*(7647163731819816e-28*t-39851014346715405e-22))-.000249472580470431))-.0007624513544032393))}(n),K[8]=function(t){return 0===t?.0009647274732138864:.0009647274732138864+t*(t*(t*(.0005140660578834113+t*(t*(9086710793521991e-20+t*(t*(10914179173496788e-22+28114572543455206e-31*t)-15303004486655377e-21))-.00029133414466938067))-.00036307660358786886)-.0003110108632631878)}(n),K[9]=function(t){return 0===t?.0005422926281312969:.0005422926281312969+t*(t*(t*(.00035764655430568635+t*(t*(.00012645437628698076+t*(t*(4890304529197534e-21+t*(822063524662433e-32*t-3.123956959982987e-7))-33202652391372056e-21))-.00028690924218514614))-.00010230378073700413)-.0003694266780000966)}(n),0+i*t(K,i*i)}var M=[0,0,0,0,0,0,0];function N(e,s){var n,i,r,a,d,l,c;return c=z(e/2,.5)*m(e*y)*s,r=e+2,a=e+4,d=e+6,M[0]=1,M[1]=-(e+1)/(2*r),r*=e+2,M[2]=-e*(e+1)*(e+3)/(8*r*a),r*=e+2,M[3]=-e*(e+1)*(e+5)*((3*e+7)*e-2)/(48*r*a*d),r*=e+2,a*=e+4,M[4]=-e*(e+1)*(e+7)*(((((15*e+154)*e+465)*e+286)*e-336)*e+64)/(384*r*a*d*(e+8)),r*=e+2,M[5]=-e*(e+1)*(e+3)*(e+9)*((((((35*e+452)*e+1573)*e+600)*e-2020)*e+928)*e-128)/(1280*r*a*d*(e+8)*(e+10)),r*=e+2,a*=e+4,d*=e+6,M[6]=-e*(e+1)*(e+11)*(((((((((((945*e+31506)*e+425858)*e+2980236)*e+11266745)*e+20675018)*e+7747124)*e-22574632)*e-8565600)*e+18108416)*e-7099392)*e+884736)/(46080*r*a*d*(e+8)*(e+10)*(e+12)),l=m(e),i=o(l*c,1/e),n=t(M,i*i),n*=l,-(n/=i)}function O(t,e){var n,i,r,a,d,l;return t>1e20?-b(2*e)*q:(a=((94.5/((i=48/((n=1/(t-.5))*n))+(r=((20700*n/i-98)*n-16)*n+96.36))-3)/i+1)*m(n*h)*t,(l=o(2*a*e,2/t))>.05+n?(d=-b(2*e)*q,t<5&&(r+=.3*(t-4.5)*(d+.6)),l=s(n*(l=(((((.4*(l=d*d)+6.3)*l+36)*l+94.5)/(r+=(((.05*a*d-5)*d-7)*d-2)*d+i)-l-3)/i+1)*d)*l)):l=((1/(((t+6)/(t*l)-.089*a-.822)*(t+2)*3)+.5/(t+4))*l-1)*(t+1)/(t+2)+1/l,-m(t*l))}function P(t,e,s){var n,i,r;return r=function(t,e,s){var n,i,r,d,c,p,f,j,h,u,z,A;if(d=0,e>s?(c=s,s=e,e=c,r=!0):r=!1,v(t)===t&&t<20)switch(n=x(1,35.333333333333336),v(t)){case 1:d=.5===e?0:-w(y*e)/l(y*e);break;case 2:d=(2*e-1)/m(2*e*s);break;case 4:i=m(4*e*s),u=4*w(k(i)/3)/i,z=m(u-4),d=e-.5<0?-z:z;break;case 6:if(e<1e-150)return(r?-1:1)*O(t,e);h=6*(1+.8549879733383485*(1/o(A=4*(e-e*e),.3333333333333333)-1));do{p=h,h=2*(8*A*(h*(j=(f=h*h)*f))-270*f+2187)/(5*(4*A*j-216*h-243))}while(a((h-p)/h)>n);h=m(h-t),d=e-.5<0?-h:h;break;default:d=t>268435456?b(2*e)*q:t<3?e>.2742-.0242143*t?L(t,e):N(t,e):e>x(1,g(t/-.654))?O(t,e):N(t,e)}else d=t>268435456?-b(2*e)*q:t<3?e>.2742-.0242143*t?L(t,e):N(t,e):e>x(1,g(t/-.654))?O(t,e):N(t,e);return r?-d:d}(n=2*t,i=e/2,1-i),s&&(s.value=r*r/(n+r*r)),n/(n+r*r)}var Q=[0,0,0,0,0,0,0],R=[0,0,0,0];var S=D/4;function T(t,e){return function(s){var n;if(0===(n=1-s))return[-S,-S];if(0===s)return[-S,-S];return[f(s)+e*f(n)+t,1/s-e/n]}}function U(t,e,s,n,i,r){var m,d,o,l,c,p,f,j,h,u;h=0,m=0,c=e,l=x(1,1-i),f=D,d=D,o=D,p=r;do{if(m=h,o=d,d=f,h=(j=t(c))[0],u=j[1],p-=1,0===h)break;if(0===u?(0===m&&(m=t(e=c===s?n:s),f=e-c),f=E(m)*E(h)<0?f<0?(c-s)/2:(c-n)/2:f<0?(c-n)/2:(c-s)/2):f=h/u,a(2*f)>a(o)&&(f=f>0?(c-s)/2:(c-n)/2),e=c,(c-=f)<=s){if((c=e-(f=.5*(e-s)))===s||c===n)break}else if(c>=n&&((c=e-(f=.5*(e-n)))===s||c===n))break;f>0?n=e:s=e}while(p&&a(c*l)<a(f));return c}var V=[0,0,0,0,0,0],W=[0,0,0,0];var X=[0,0,0,0,0];function Y(v,g,k,y){var z,K,L,M,N,O,S,Y,Z,$,_,tt,et,st,nt,it,rt,mt,at,dt,ot,lt,ct,pt,ft,jt,ht;if(K=!1,0===y)return[1,0];if(0===k)return[0,1];if(1===v){if(1===g)return[k,1-k];tt=g,g=v,v=tt,tt=y,y=k,k=tt,K=!0}if(jt=0,M=0,O=1,.5===v){if(.5===g)return jt=l(k*h),jt*=jt,ht=l(y*h),[jt,ht*=ht];g>.5&&(tt=g,g=v,v=tt,tt=y,y=k,k=tt,K=!K)}if(.5===g&&v>=.5&&1!==k)jt=P(v,k,dt={}),ht=dt.value;else{if(1===g)return k<y?v>1?(jt=o(k,1/v),ht=-s(f(k)/v)):ht=1-(jt=o(k,1/v)):(jt=d(n(-y)/v),ht=-s(n(-y)/v)),K&&(tt=ht,ht=jt,jt=tt),[jt,ht];if(v+g>5)k>.5&&(tt=g,g=v,v=tt,tt=y,y=k,k=tt,K=!K),Z=p(v,g),Y=c(v,g),m(Z)>Y-Z&&Z>5?(jt=function(t,e,s){var n,i,r,a,d,o,l;return n=b(2*s),n/=-m(t/2),R[0]=n,d=(a=(o=e-t)*o)*o,Q[0]=-o*q/2,Q[1]=(1-2*o)/8,Q[2]=-o*q/48,Q[3]=-1/192,Q[4]=-o*q/3840,Q[5]=0,Q[6]=0,R[1]=A(Q,n),Q[0]=o*q*(3*o-2)/12,Q[1]=(20*a-12*o+1)/128,Q[2]=o*q*(20*o-1)/960,Q[3]=(16*a+30*o-15)/4608,Q[4]=o*q*(21*o+32)/53760,Q[5]=(-32*a+63)/368640,Q[6]=-o*q*(120*o+17)/25804480,R[2]=A(Q,n),Q[0]=o*q*(-75*a+80*o-16)/480,Q[1]=(-1080*d+868*a-90*o-45)/9216,Q[2]=o*q*(-1190*a+84*o+373)/53760,Q[3]=(-2240*d-2508*a+2100*o-165)/368640,Q[4]=0,Q[5]=0,Q[6]=0,R[3]=A(Q,n),r=A(R,1/t),l=-B(-(i=r*r)/2),0===i?.5:(1+r*m((1+l)/i))/2}(v,g,k),ht=1-jt):(N=i(m(v/(pt=v+g))),(L=Z/pt)>=.2&&L<=.8&&pt>=10?(jt=(_=o(k,1/v))<.0025&&v+g<200?_*o(v*r(v,g),1/v):function(t,e,s){var n,i,r,d,o,l,c,p,j,h,u,v,x,g,k,q,y,z,D;return d=b(2*t)/-m(e/2),y=C(s),q=w(s),W[0]=d,g=y*y,k=q*q,p=(u=(v=y*q)*v)*(h=u*v),c=h*h,l=(j=u*u)*h,V[0]=(2*g-1)/(3*v),V[1]=-function(t){return 0===t?-1:t*(5*t-5)-1}(g)/(36*u),V[2]=function(t){return 0===t?1:1+t*(21+t*(46*t-69))}(g)/(1620*h),V[3]=function(t){return 0===t?7:7+t*(t*(33+t*(31*t-62))-2)}(g)/(6480*j),V[4]=function(t){return 0===t?25:25+t*(t*(t*(88+t*(46*t-115))-17)-52)}(g)/(90720*p),V[5]=0,W[1]=A(V,d),V[0]=-function(t){return 0===t?7:7+t*(12+t*(52*t-78))}(g)/(405*h),V[1]=function(t){return 0===t?-7:t*(2+t*(183+t*(185*t-370)))-7}(g)/(2592*j),V[2]=-function(t){return 0===t?-533:t*(776+t*(t*(10240+t*(5410*t-13525))-1835))-533}(g)/(204120*p),V[3]=-function(t){return 0===t?-1579:t*(3747+t*(t*(t*(45588+t*(15071*t-45213))-15821)-3372))-1579}(g)/(2099520*c),V[4]=0,V[5]=0,W[2]=A(V,d),V[0]=function(t){return 0===t?449:449+t*(t*(t*(6686+t*(3704*t-9260))-769)-1259)}(g)/(102060*p),V[1]=-function(t){return 0===t?63149:63149+t*(t*(140052+t*(t*(2239932+t*(750479*t-2251437))-727469))-151557)}(g)/(20995200*c),V[2]=function(t){return 0===t?29233:29233+t*(t*(105222+t*(146879+t*(t*(3195183+t*(729754*t-2554139))-1602610)))-78755)}(g)/(36741600*l),V[3]=0,V[4]=0,V[5]=0,W[3]=A(V,d),r=q/y,r*=r,x=-(o=A(W,1/e))*o/(2*g)+f(g)+k*f(k)/g,a(o)<.7?(V[0]=g,V[1]=v,V[2]=(1-2*g)/3,V[3]=function(t){return 0===t?1:1+t*(13*t-13)}(g)/(36*v),V[4]=function(t){return 0===t?1:1+t*(21+t*(46*t-69))}(g)/(270*u),V[5]=0,D=A(V,o)):(z=B(x),V[0]=z,V[1]=r,V[2]=0,V[3]=3*r*(3*r+1)/6,V[4]=4*r*(4*r+1)*(4*r+2)/24,V[5]=5*r*(5*r+1)*(5*r+2)*(5*r+3)/120,((D=A(V,z))-g)*o<0&&(D=1-D)),o<0?(i=0,n=g):(i=g,n=1),(D<i||D>n)&&(D=(i+n)/2),U(T(-x,r),D,i,n,32,100)}(k,pt,N),ht=1-jt):(v<g&&(tt=g,g=v,v=tt,tt=y,y=k,k=tt,K=!K),$=0,g<2&&($=r(v,g)),0===$?ht=1:jt=1-(ht=o(g*y*$,1/g))),ht>1e-5&&(jt=function(t,e,s,n){var i,r,a,d,o,l,c,p,j,h,u,b,v,x,g,k,w,q,y,z,A,B,C,D,E,H;return d=s<n?F(s,e,!0):F(n,e,!1),d/=t,j=((E=m(1+(b=e/t)))+2)*(E-1)/(3*E),j+=((k=(g=E*E)*E)+9*g+21*E+5)*(D=d-b)/(36*g*(C=E+1)),j-=((w=g*g)-13*k+69*g+167*E+46)*(v=D*D)/(1620*(l=C*C)*k),j-=(7*(q=k*g)+21*w+70*k+26*g-93*E-31)*(x=v*D)/(6480*(c=C*l)*w),h=(28*w+131*k+402*g+581*E+208)*(E-1)/(1620*C*k),h-=(35*(y=k*k)-154*q-623*w-1636*k-3983*g-3514*E-925)*D/(12960*l*w),h-=(2132*(z=w*k)+7915*y+16821*q+35066*w+87490*k+141183*g+95993*E+21640)*v/(816480*q*c),u=-(3592*z+8375*y-1323*q-29198*w-89578*k-154413*g-116063*E-29632)*(E-1)/(816480*q*l),u-=(442043*(B=q*w)+2054169*(A=w*w)+3803094*z+3470754*y+2141568*q-2393568*w-19904934*k-34714674*g-23128299*E-5253353)*D/(146966400*y*c),(o=d+(j-=v*v*(75*y+202*q+188*w-888*k-1345*g+118*E+138)/(272160*(p=l*l)*q))/t+(h-=(11053*A+53308*z+117010*y+163924*q+116188*w-258428*k-677042*g-481940*E-105497)*x/(14696640*p*y))/(t*t)+(u-=(q*q*116932+819281*B+2378172*A+4341330*z+6806004*y+10622748*q+18739500*w+30651894*k+30869976*g+15431867*E+2919016)*v/(146966400*p*z))/(t*t*t))<=0&&(o=G),i=1/(1+b),H=((r=o<b?i:0)+(a=o<b?1:i))/2,U(T(o-b*f(o)+(1+b)*f(1+b)-b,b),H,r,a,32,100)}(v,g,k,y),ht=1-jt));else if(v<1&&g<1){if(it=e(at=(1-v)/(2-v-g),v,g)-k,a(it)/k<3*u)return K?[1-at,at]:[at,1-at];it<0&&(tt=g,g=v,v=tt,tt=y,y=k,k=tt,K=!K,at=1-at),ht=1/(1+(mt=o(v*k*r(v,g),1/v))),(jt=mt/(1+mt))>at&&(jt=at),O=at}else v>1&&g>1?(et=(g-1)/(v+g-2),e(at=(v-1)/(v+g-2),v,g)-k<0&&(tt=g,g=v,v=tt,tt=y,y=k,k=tt,tt=et,et=at,at=tt,K=!K),rt=f(k*v*r(v,g))/v,ht=(jt=d(rt))<.9?1-jt:-s(rt),g<v&&jt<.2&&(st=v-1,nt=g-1,lt=v*(ot=v*v),ct=g*g,X[0]=0,X[1]=1,X[2]=nt/st,st*=st,X[3]=nt*(3*v*g+5*g+ot-v-4)/(2*(v+2)*st),st*=v+1,X[4]=nt*(33*v*ct+31*ct+8*ot*ct-30*v*g-47*g+11*ot*g+6*lt*g+18+4*v-lt+ot*ot-10*ot),X[4]/=3*(v+3)*(v+2)*st,jt=t(X,jt)),jt>at&&(jt=at),O=at):(g<v&&(tt=g,g=v,v=tt,tt=y,y=k,k=tt,K=!K),o(k,1/v)<.5?(0===(jt=o(k*v*r(v,g),1/v))&&(jt=j),ht=1-jt):(0===(ht=o(1-o(k,g*r(v,g)),1/g))&&(ht=j),jt=1-ht))}return jt>.5&&(tt=g,g=v,v=tt,tt=y,y=k,k=tt,tt=ht,ht=jt,jt=tt,K=!K,ft=1-M,M=1-O,O=ft),0===M&&(K?jt<(M=u)&&(jt=M):M=j,jt<M&&(jt=M)),z=32,jt<1e-50&&(v<1||g<1)&&(z*=3,z/=2),S=function(t,e,s,n){return function(i){var r,m,a,d,o;return o=1-i,J(i,t,e,!0,n,r=[0,0],1,0),d=r[0]-s,m=r[1],n&&(m=-m),0===o&&(o=64*j),0===i&&(i=64*j),H(a=m*(-o*t+(e-2)*i+1))<o*i*D&&(a/=o*i),n&&(a=-a),0===m&&(m=(n?-1:1)*j*64),[d,m,a]}}(v,g,k<y?k:y,k>=y),jt=function(t,e,s,n,i,r){var m,a,d,o,l,c,p,f,j,h,u,b,v,g,k,w;g=0,a=!1,c=e,l=x(1,1-i),p=0,d=j=I(1e7*e,1e7),o=j,f=r;do{if(p=g,o=d,d=j,g=(v=t(c))[0],k=v[1],w=v[2],f-=1,0===g)break;if(0===k?(0===p&&(p=t(e=c===s?n:s),j=e-c),j=E(p)*E(g)<0?j<0?(c-s)/2:(c-n)/2:j<0?(c-n)/2:(c-s)/2):0===w?j=g/k:(h=2*g,(j=H(b=2*k-g*(w/k))<1&&H(h)>=H(b)*D?g/k:h/b)*k/g<0&&H(j=g/k)>2*H(e)&&(j=2*(j<0?-1:1)*H(e))),(m=H(j/o))>.8&&m<2&&(H(j=j>0?(c-s)/2:(c-n)/2)>c&&(j=E(j)*c),o=3*j),e=c,(c-=j)<s){if(u=H(s)<1&&H(c)>1&&D/H(c)<H(s)?1e3:c/s,H(u)<1&&(u=1/u),!a&&u>0&&u<3)c=e-(j=.99*(e-s)),a=!0;else if((c=e-(j=(e-s)/2))===s||c===n)break}else if(c>n)if(u=H(n)<1&&H(c)>1&&D/H(c)<H(n)?1e3:c/n,H(u)<1&&(u=1/u),!a&&u>0&&u<3)c=e-(j=.99*(e-n)),a=!0;else if((c=e-(j=(e-n)/2))===s||c===n)break;j>0?n=e:s=e}while(f&&H(c*l)<H(j));return c}(S,jt,M,O,z,1e3),jt===M&&(jt=0),K?[1-jt,jt]:[jt,1-jt]}export{Y as default};
//# sourceMappingURL=index.mjs.map
